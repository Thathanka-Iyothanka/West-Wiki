ui={lang:{input_level:"Your level",input_search:"Search",damages:"Damages",per_level:"per Level",speed:"Speed",level:"Level",unsalable:"Unsalable",auction:"Auctionable",not_auction:"Not auctionable",not_upgrade:"Not upgradeable",upgrade:"Upgradeable",total:"Total",popup:{dmg:{dmglvl:'<p class="popup_dmg">+ #1 Damages#2</p>'},skills:{str:'<p class="popup_attribute">+ #1 Strength#2</p>',mob:'<p class="popup_attribute">+ #1 Mobility#2</p>',dex:'<p class="popup_attribute">+ #1 Dexterity#2</p>',cha:'<p class="popup_attribute">+ #1 Charisma#2</p>',con:'<p class="popup_skill">+ #1 Construction#2</p>',vig:'<p class="popup_skill">+ #1 Vigor#2</p>',tou:'<p class="popup_skill">+ #1 Toughness#2</p>',sta:'<p class="popup_skill">+ #1 Stamina#2</p>',hea:'<p class="popup_skill">+ #1 Health Points#2</p>',rid:'<p class="popup_skill">+ #1 Horseback Riding#2</p>',ref:'<p class="popup_skill">+ #1 Reflex#2</p>',dod:'<p class="popup_skill">+ #1 Dodging#2</p>',hid:'<p class="popup_skill">+ #1 Hiding#2</p>',swi:'<p class="popup_skill">+ #1 Swimming#2</p>',aim:'<p class="popup_skill">+ #1 Aiming#2</p>',sho:'<p class="popup_skill">+ #1 Shooting#2</p>',pit:'<p class="popup_skill">+ #1 Setting traps#2</p>',fin:'<p class="popup_skill">+ #1 Fine Motor Skills#2</p>',rep:'<p class="popup_skill">+ #1 Repairing#2</p>',lea:'<p class="popup_skill">+ #1 Leadership#2</p>',tac:'<p class="popup_skill">+ #1 Tactics#2</p>',tra:'<p class="popup_skill">+ #1 Trading#2</p>',ani:'<p class="popup_skill">+ #1 Animal Instinct#2</p>',app:'<p class="popup_skill">+ #1 Appearance#2</p>'},fb:{fbdef:'<p class="popup_fb">+ #1 <b>Defense</b> (Fort battle bonus)#2</p>',fboff:'<p class="popup_fb">+ #1 <b>Attack</b> (Fort battle bonus)#2</p>',fbres:'<p class="popup_fb">+ #1 <b>Resistance</b> (Fort battle bonus)#2</p>',fbdefs:'<p class="popup_fb">+ #1 <b>Defense</b> (Fort battle sector bonus)#2</p>',fboffs:'<p class="popup_fb">+ #1 <b>Attack</b> (Fort battle sector bonus)#2</p>',fbdmgs:'<p class="popup_fb">+ #1 <b>Damages</b> (Fort battle sector bonus)#2</p>'},special:{xp:"+ #1% Experience from jobs, duels and fort battles#2",money:"+ #1% Money from jobs and duels#2",luck:"+ #1% Improved Luck#2",regen:"+ #1% Regeneration#2",drop:"+ #1 Improved drop chance#2",labor_pts:"+ #1 labor point#2"}}},config:{enable_set_calc:!0,redirect_on_dblclick:!1,cdn:"https://westzz.innogamescdn.com",img_buyprice:"/images/5/57/Buy_price.png",img_sellprice:"/images/f/fc/Sell_price.png",img_male:"/images/c/c5/Gender_m.png",img_female:"/images/4/41/Gender_f.png",set_bonus:{str:{name:"Strength",img:"/images/thumb/8/8b/Strength.png/40px-Strength.png"},mob:{name:"Mobility",img:"/images/thumb/5/5a/Mobility.png/40px-Mobility.png"},dex:{name:"Dexterity",img:"/images/thumb/0/0d/Dexterity.png/40px-Dexterity.png"},cha:{name:"Charisma",img:"/images/thumb/c/c9/Charisma.png/40px-Charisma.png"},con:{name:"Construction",img:"/images/thumb/3/37/Construction.png/40px-Construction.png"},vig:{name:"Vigor",img:"/images/thumb/9/90/Skill_Punch.png/40px-Skill_Punch.png"},tou:{name:"Toughness",img:"/images/thumb/f/f8/Skill_Tough.png/40px-Skill_Tough.png"},sta:{name:"Stamina",img:"/images/thumb/8/8d/Stamina.png/40px-Stamina.png"},hea:{name:"Health Points",img:"/images/thumb/9/94/Health.png/40px-Health.png"},rid:{name:"Horseback Riding",img:"/images/thumb/7/78/Hbr.png/40px-Hbr.png"},ref:{name:"Reflex",img:"/images/thumb/e/e9/Skill_Reflex.png/40px-Skill_Reflex.png"},dod:{name:"Dodging",img:"/images/thumb/0/07/Skill_Dodge.png/40px-Skill_Dodge.png"},hid:{name:"Hiding",img:"/images/thumb/9/97/Hiding.png/40px-Hiding.png"},swi:{name:"Swimming",img:"/images/thumb/f/f4/Swimming.png/40px-Swimming.png"},aim:{name:"Aiming",img:"/images/thumb/5/53/Skill_Aim.png/40px-Skill_Aim.png"},sho:{name:"Shooting",img:"/images/thumb/7/73/Skill_Shot.png/40px-Skill_Shot.png"},pit:{name:"Setting traps",img:"/images/thumb/e/e1/Trapping.png/40px-Trapping.png"},fin:{name:"Fine Motor Skills",img:"/images/thumb/1/18/Fms.png/40px-Fms.png"},rep:{name:"Repairing",img:"/images/thumb/d/d5/Repairing.png/40px-Repairing.png"},lea:{name:"Leadership",img:"/images/thumb/4/44/Leadership.png/40px-Leadership.png"},tac:{name:"Tactics",img:"/images/thumb/9/91/Skill_Tactic.png/40px-Skill_Tactic.png"},tra:{name:"Trading",img:"/images/thumb/f/f3/Skill_Trading.png/40px-Skill_Trading.png"},ani:{name:"Animal Instinct",img:"/images/thumb/9/9d/AnimalInstinct.png/40px-AnimalInstinct.png"},app:{name:"Appearance",img:"/images/thumb/4/4c/Skill_Appearance.png/40px-Skill_Appearance.png"},fbdef:{name:"<b>Defense</b> (Fort battle bonus)",img:"/images/8/82/Set_Fb_defense.png"},fboff:{name:"<b>Attack</b> (Fort battle bonus)",img:"/images/3/30/Set_Fb_offense.png"},fbres:{name:"<b>Resistance</b> (Fort battle bonus)",img:"/images/4/4b/Resistance.png"},fbdefs:{name:"<b>Defense</b> (Fort battle sector bonus)",img:"/images/1/1a/Set_Fb_defense_sec.png"},fboffs:{name:"<b>Attack</b> (Fort battle sector bonus)",img:"/images/f/fe/Set_Fb_offense_sec.png"},fbdmgs:{name:"<b>Damages</b> (Fort battle sector bonus)",img:"/images/b/b3/Damages_sector.png"},xp:{name:"Experience from jobs, duels, and fort battles (%)",img:"/images/7/71/Set_xp.png"},money:{name:"Money from jobs and duels (%)",img:"/images/d/df/Set_money.png"},luck:{name:"Increased Luck",img:"/images/c/c1/Set_luck.png"},regen:{name:"Regeneration",img:"/images/5/53/Regeneration.png"},drop:{name:"Improved drop chance",img:"/images/thumb/b/b8/Drop.png/40px-Drop.png"},labor_pts:{name:"Labor points (all jobs)",img:"/images/5/5e/Labor_pts.png"}}},initPage:function(){if(1===$("#input_level").length)var t=$('<input type="number" style="width:80px;" class="west" placeholder="'+ui.lang.input_level+'" min="0" max="150">').bind("propertychange keyup input paste",function(){this.value>150?this.value=150:this.value<0&&(this.value=0),$(".calc").each(function(){0==t.val()?($(this).html(this.id),$(".per_level_off").addClass("per_level").removeClass("per_level_off")):($(this).html(Math.ceil(Number(this.id)*t.val())),$(".per_level").addClass("per_level_off").removeClass("per_level"))})}).appendTo($("#input_level"));if(1===$("#input_search").length)$('<input type="search" class="west" placeholder="'+ui.lang.input_search+'">').bind("propertychange keyup input paste",function(){var t=this.value.toLowerCase();""===t?$(".item_container").show():($(".item_container").hide(),$(".item_container").filter(function(){return $(this).attr("data-popup").toLowerCase().indexOf(t)>-1}).show())}).appendTo($("#input_search"));1===$("#switch").length&&($("#fire").hide(),$("#switch").on("click",function(){$("#melee, #fire").toggle()})),new RegExp(mw.config.get("wgFormattedNamespaces")[10]+":Item_*").test(mw.config.get("wgPageName"))&&1===$(".item_container").length&&($("#mw-content-text").append('<center><div id="popup_plain" class="popup_window"><div class="popup_front"><div class="tw_bg_tl"></div><div class="tw_bg_tr"></div><div class="tw_bg_bl"></div><div class="tw_bg_br"></div></div><div id="popup_plain_contents" class="popup_contents"></div></div></center>'),$("#popup_plain").hide(),$("#popup_plain_contents").append(ui.popup.createPopup($(".item_container").attr("data-popup"),$(".item_container").attr("data-cdn-cat"),$(".item_container").attr("data-cdn-img"),0)),$("#popup_plain").slideDown()),ui.config.redirect_on_dblclick&&$(".item_container img").on("dblclick",function(){window.location="/wiki/"+mw.config.get("wgFormattedNamespaces")[10]+":Item_"+JSON.parse($(this).parent().attr("data-popup")).id/1e3})},popup:{content:"",delay:200,active:!1,show:function(t){ui.popup.content=ui.popup.createPopup($(t).attr("data-popup"),$(t).attr("data-cdn-cat"),$(t).attr("data-cdn-img"),parseInt($(t).attr("data-lvl"))),ui.popup.active=!0,ui.popup.setTimeout(),ui.popup.getContainer().html(ui.popup.content)},hide:function(){ui.popup.getEl().css({display:"none",top:0,left:0}),ui.popup.active=!1,ui.popup.clearTimeout()},setTimeout:function(){ui.popup.clearTimeout(),ui.popup.timer=window.setTimeout(function(){ui.popup.getEl().css("display","block")},ui.popup.delay)},clearTimeout:function(){ui.popup.timer&&window.clearTimeout(ui.popup.timer)},getEl:function(){return $("#popup_window")},getContainer:function(){return $("#popup_contents")},createPopup:function(t,e,i,a){t=JSON.parse(t);var p='<div class="popup_image"><img src="'+ui.config.cdn+"/images/items/"+t.cdn_cat+"/"+t.cdn_img+'.png"/></div><div class="popup_divider"></div><p class="popup_name">'+t.name+'</p><p class="popup_type">'+t.type+"</p><br/>",n=!1;if(a>=1&&a<=5&&(n=!0,t.auc=!1),t.dmg_min&&t.dmg_max&&(n&&(t.dmg_min+=Math.round(Math.max(1,.1*t.dmg_min*a)),t.dmg_max+=Math.round(Math.max(1,.1*t.dmg_max*a))),p+='<p class="popup_dmg">'+t.dmg_min+"-"+t.dmg_max+" "+ui.lang.damages+"</p>"),t.text){for(var s=0;s<t.text.length;s++)p+='<p class="popup_text">'+t.text[s]+"</p>";p+="<br/>"}for(var o in ui.lang.popup){var l=0;for(var c in ui.lang.popup[o])if(t.hasOwnProperty(c)){l++;var u="";t[c]<0?$("#input_level input").val()>0?(t[c]=Math.ceil($("#input_level input").val()*-t[c]),n&&(t[c]+=Math.round(Math.max(1,.1*t[c]*a)))):(t[c]=-t[c],u=" ("+ui.lang.per_level+")",n&&(t[c]=Math.round(1e6*(1*t[c]+Math.round(Math.max(1,1e3*t[c]*a))/1e4))/1e6)):n&&(t[c]<1?t[c]=Math.round(1e6*(1*t[c]+Math.round(Math.max(1,1e3*t[c]*a))/1e4))/1e6:t[c]+=Math.round(Math.max(1,.1*t[c]*a))),p+=ui.lang.popup[o][c].replace("#1",t[c]).replace("#2",u)}l>0&&(p+="<br/>")}if(t.textjob){for(s=0;s<t.textjob.length;s++)p+='<p class="popup_txtgreen">'+t.textjob[s]+"</p>";p+="<br/>"}if(t.bonus){for(s=0;s<t.bonus.length;s++)p+='<p class="popup_bonus">'+t.bonus[s]+"</p>";p+="<br/>"}if(t.jobs){p+='<div style="text-align:center;"><table class="popup_job">';for(s=0;s<t.jobs.length;s++)p+='<tr><td><img src="'+ui.config.cdn+"/images/jobs/"+t.jobs[s][1]+'.png"/></td><td><span>&nbsp;&nbsp;'+t.jobs[s][0]+"</span></td></tr>";p+="</table></div>"}if(t.craft){p+='<div style="text-align:center;"><table  class="popup_crafteditem"><tr><td><img src="'+ui.config.cdn+"/images/crafting/profsymbol_"+t.craft.id+'_small.png"/></td><td><table><tr>';for(s=0;s<t.craft.req.length;s++)p+='<td><img style="width:36px;height:36px;" src="'+ui.config.cdn+"/images/items/yield/"+t.craft.req[s][0]+'.png"/></td>';p+="</tr><tr>";for(s=0;s<t.craft.req.length;s++)p+="<td><span>x"+t.craft.req[s][1]+"</span></td>";p+="</tr></table></td></tr></table></div>"}return p+='<div class="popup_infos">',t.spd&&(n&&(t.spd+=Math.round(Math.max(1,.1*t.spd*a))),p+='<p class="popup_speed">'+ui.lang.speed+": +"+t.spd+"%</p><br/>"),t.set&&(p+='<p><a class="popup_set" href="/wiki/'+t.set+'">'+t.set+"</a></p><br/>"),t.sp?p+='<img src="'+ui.config.img_buyprice+'"/>'+t.bp+'&nbsp;&nbsp;&nbsp;&nbsp;<img src="'+ui.config.img_sellprice+'"/>&nbsp;'+t.sp+"<br/><br/>":p+="<i>"+ui.lang.unsalable+"</i><br/><br/>",t.lvl&&(p+=ui.lang.level+" <b>"+t.lvl+"</b><br/>"),t.sex&&(0==t.sex?p+='<img src="'+ui.config.img_male+'"/>&nbsp;&nbsp;&nbsp;':p+='<img src="'+ui.config.img_female+'"/>&nbsp;&nbsp;&nbsp;'),1==t.auc?p+='<span class="popup_txtgreen">'+ui.lang.auction+"</span><br/>":p+='<span class="popup_txtred">'+ui.lang.not_auction+"</span><br/>",0==t.upg?p+='<span class="popup_txtred">'+ui.lang.not_upgrade+"</span><br/>":p+='<span class="popup_txtgreen">'+ui.lang.upgrade+"</span><br/>",p+='<br/><p class="popup_id">[item=<b>'+t.id+"</b>]</p></div>"},setPosition:function(t){var e,i,a=$(window).width(),p=$(window).height(),n=ui.popup.getEl().outerWidth(),s=ui.popup.getEl().outerHeight(),o=t.clientX,l=t.clientY;i=o+n+20>a?o-n-20+(t.pageX-t.clientX):o+20+(t.pageX-t.clientX),e=l+s+20>p?p-s+(t.pageY-t.clientY):l+20+(t.pageY-t.clientY),ui.popup.getEl().css({top:e,left:i})},init:function(){$("body").append('<div id="popup_window" class="popup_window"><div class="popup_front"><div class="tw_bg_tl"></div><div class="tw_bg_tr"></div><div class="tw_bg_bl"></div><div class="tw_bg_br"></div></div><div id="popup_contents" class="popup_contents"></div></div>'),$(document).on("mouseenter",".item_container",function(t){ui.popup.show(this),ui.popup.setPosition(t)}),$(document).on("mouseleave",".item_container",function(){ui.popup.hide()}),$(document).on("mousemove",".item_container",function(t){ui.popup.setPosition(t)}),$(".item_level").mousedown(function(t){t.preventDefault()}),$(document).on("click",".upgrade",function(){var t=$(this).closest(".item_container"),e=parseInt(t.attr("data-lvl"));5!==e&&(t.attr("data-lvl",e+1),t.find(".level").html(e+1)),ui.popup.show(t[0])}),$(document).on("click",".downgrade",function(){var t=$(this).closest(".item_container"),e=parseInt(t.attr("data-lvl"));0!==e&&(t.attr("data-lvl",e-1),t.find(".level").html(e-1)),ui.popup.show(t[0])})}},set_calc:{bonus:{extra_set_bonus:{}},data:{},itemStatus:{},getData:function(){$(".set_container").each(function(){var t=$(this).attr("data-set-id");ui.set_calc.itemStatus[t]={},ui.set_calc.data[t]={items:{},set:{}},$(this).find(".item_container").each(function(){var e=JSON.parse($(this).attr("data-popup"));for(var i in $(this).is(":hidden")?ui.set_calc.itemStatus[t][e.id]=!1:ui.set_calc.itemStatus[t][e.id]=0,e)e.hasOwnProperty(i)&&ui.config.set_bonus.hasOwnProperty(i)&&(ui.set_calc.data[t].items[i]||(ui.set_calc.data[t].items[i]={}),ui.set_calc.data[t].items[i][e.id]=e[i])})}),$(".infoSet").each(function(){var t=$(this).attr("data-set-id");$(this).find(".infosetatt").each(function(){var e=$(this).attr("data-nb");ui.set_calc.data[t].set[e]={},$(this).find(".set_bonus").each(function(){key=$(this).attr("data-type"),0!==$(this).find(".calc").length?ui.set_calc.data[t].set[e][key]=-parseFloat($(this).find(".calc").attr("id")):ui.set_calc.data[t].set[e][key]=parseFloat($(this).find(".val").text()),ui.config.set_bonus.hasOwnProperty(key)||(ui.set_calc.bonus.extra_set_bonus[key]={img:$(this).find("img").attr("src"),name:$(this).find("#tooltip_content").text()})})})})},calc:function(){if(0===$("#input_level").length|""!==$("#input_level input").val()){var t=parseInt($("#input_level input").val());for(var e in total={},ui.set_calc.data){for(var i in ui.set_calc.data[e].items)for(var a in ui.set_calc.data[e].items[i])if(!1!==ui.set_calc.itemStatus[e][a]){lvl=ui.set_calc.itemStatus[e][a],total[i]||(total[i]=0);var p=ui.set_calc.data[e].items[i][a];ui.set_calc.data[e].items[i][a]<0?(p=-p,ui.set_calc.itemStatus[e][a]>0?total[i]+=Math.ceil(p*t)+Math.round(Math.max(1,.1*Math.ceil(p*t)*lvl)):total[i]+=Math.ceil(p*t)):ui.set_calc.itemStatus[e][a]>0?total[i]+=p<1?Math.round(1e6*(1*p+Math.round(Math.max(1,1e3*p*lvl))/1e4))/1e6:Math.round(Math.max(1,.1*p*lvl)):total[i]+=p}var n=0;for(var a in ui.set_calc.itemStatus[e])!1!==ui.set_calc.itemStatus[e][a]&&n++;for(var i in ui.set_calc.data[e].set[n])total[i]||(total[i]=0),ui.set_calc.data[e].set[n][i]<0?total[i]+=Math.ceil(-ui.set_calc.data[e].set[n][i]*t):total[i]+=ui.set_calc.data[e].set[n][i]}var s='<center><table class="infoSet"><caption><br><big><b>'+ui.lang.total+"</b></big></caption><tbody><tr><td></center>";for(var i in ui.config.set_bonus)total.hasOwnProperty(i)&&(s+='<div class="set_bonus tooltip_container"><img src="'+ui.config.set_bonus[i].img+'"><b>+'+total[i]+'</b><div class="tooltip_outer"><div class="tooltip"><div class="tt_bg_tl"></div><div class="tt_bg_tr"></div><div class="tt_bg_bl"></div><div class="tt_bg_br"></div><div id="tooltip_content">'+ui.config.set_bonus[i].name+"</div></div></div></div>");for(var i in ui.set_calc.bonus.extra_set_bonus)total.hasOwnProperty(i)&&(s+='<div class="set_bonus tooltip_container"><img src="'+ui.set_calc.bonus.extra_set_bonus[i].img+'"><b>+'+total[i]+(-1!==["xp","money","luck","spd","regen","drop"].indexOf(i)?"%":"")+'</b><div class="tooltip_outer"><div class="tooltip"><div class="tt_bg_tl"></div><div class="tt_bg_tr"></div><div class="tt_bg_bl"></div><div class="tt_bg_br"></div><div id="tooltip_content">'+ui.set_calc.bonus.extra_set_bonus[i].name+"</div></div></div></div>");$("#set_calc").html(s)}else $("#set_calc").html("")},initEvents:function(){$(".item_container > img").on("click",function(){var t=$(this).closest(".item_container");t.toggleClass("item_off");var e=t.closest(".set_container").attr("data-set-id"),i=JSON.parse(t.attr("data-popup")).id;t.hasClass("item_off")||t.is(":hidden")?ui.set_calc.itemStatus[e][i]=!1:ui.set_calc.itemStatus[e][i]=parseInt(t.attr("data-lvl")),ui.set_calc.calc()}),$(document).on("click",".upgrade, .downgrade",function(){var t=$(this).closest(".item_container"),e=t.closest(".set_container").attr("data-set-id");t.hasClass("item_off")||t.is(":hidden")||(ui.set_calc.itemStatus[e][JSON.parse(t.attr("data-popup")).id]=parseInt(t.attr("data-lvl")),ui.set_calc.calc())}),$("#input_level").bind("propertychange keyup input paste",function(){ui.set_calc.calc()}),$("#switch").on("click",function(){$("#melee, #fire").each(function(){var t=$(this).find(".item_container"),e=$(this).closest(".set_container").attr("data-set-id");$(this).is(":hidden")?ui.set_calc.itemStatus[e][JSON.parse(t.attr("data-popup")).id]=!1:ui.set_calc.itemStatus[e][JSON.parse(t.attr("data-popup")).id]=parseInt(t.attr("data-lvl"))}),ui.set_calc.calc()})},init:function(){ui.set_calc.initEvents(),ui.set_calc.getData(),$("#mw-content-text").append('<div id="set_calc"></div>'),0===$("#input_level").length&&ui.set_calc.calc()}},init:function(){ui.initPage(),ui.popup.init(),ui.config.enable_set_calc&&0!==$(".infoSet").length&&ui.set_calc.init()}},ui.init();
